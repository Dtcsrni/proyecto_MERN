flowchart LR
  classDef user fill:#fff6e5,stroke:#f59e0b,color:#7c2d12;
  classDef svc fill:#e0f2fe,stroke:#0284c7,color:#0c4a6e;
  classDef db fill:#ecfccb,stroke:#65a30d,color:#365314;
  classDef store fill:#f5f5f4,stroke:#78716c,color:#1c1917;
  classDef cloud fill:#ede9fe,stroke:#7c3aed,color:#4c1d95;
  classDef ext fill:#fde2e2,stroke:#dc2626,color:#7f1d1d;

  subgraph Local["Entorno local (Docente)"]
    userDoc[Docente]:::user
    webDoc[Web Docente<br/>React + Vite]:::svc
    apiDoc[API Docente<br/>Express + TS]:::svc
    mongo[(MongoDB Local)]:::db
    pdfStore[[PDFs locales<br/>data/examenes]]:::store
    omr[Modulo OMR/PDF/QR<br/>sharp + pdf-lib + qrcode]:::svc
  end

  subgraph Cloud["Nube (Portal Alumno)"]
    userAlu[Alumno]:::user
    webAlu[Web Alumno<br/>React app_alumno]:::svc
    apiPortal[API Portal Alumno<br/>Express + TS]:::cloud
    mongoCloud[(MongoDB Cloud)]:::db
  end

  userDoc --> webDoc
  webDoc -->|HTTP JSON| apiDoc
  apiDoc -->|CRUD| mongo
  apiDoc -->|genera PDF| pdfStore
  apiDoc -->|procesa imagenes| omr

  apiDoc -->|publicacion resultados<br/>API Key| apiPortal
  apiPortal -->|persistencia| mongoCloud

  userAlu --> webAlu
  webAlu -->|HTTP JSON| apiPortal

  extMail[Correo opcional]:::ext
  apiDoc -.->|codigo acceso| extMail