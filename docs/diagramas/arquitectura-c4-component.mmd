%%{init: {'theme':'base','themeVariables':{ 'primaryColor':'#e0f2fe', 'primaryTextColor':'#0c4a6e', 'primaryBorderColor':'#0284c7', 'lineColor':'#334155' }}}%%
C4Component
title Sistema de Evaluacion Universitaria - Componentes API Docente
LAYOUT_TOP_DOWN()

Person(docente, "Docente", "Opera el panel local")
Container(webDoc, "Web Docente", "React + Vite", "UI docente")

Container_Boundary(api, "API Docente") {
  Component(auth, "Modulo Autenticacion", "Express handlers", "Login, JWT y perfil")
  Component(alumnos, "Modulo Alumnos", "Express handlers", "Periodos y alumnos")
  Component(banco, "Modulo Banco Preguntas", "Express handlers", "Versionado de preguntas")
  Component(plantillas, "Modulo Generacion de PDF", "Express handlers", "Plantillas, PDFs y QR")
  Component(omr, "Modulo Escaneo OMR", "Servicio", "Lectura de marcas")
  Component(vinculacion, "Modulo Vinculacion de Entrega", "Express handlers", "Folio-alumno")
  Component(calificacion, "Modulo Calificacion", "Express handlers", "Calculo y resultados")
  Component(analiticas, "Modulo Analiticas", "Express handlers", "CSV y banderas")
  Component(sync, "Modulo Sincronizacion con Nube", "Express handlers", "Publicacion al portal")
}

ContainerDb(mongoLocal, "MongoDB Local", "MongoDB", "Datos docentes")
System_Ext(pdfStore, "PDFs locales", "Filesystem")
System_Ext(portalApi, "API Portal Alumno", "HTTP")
System_Ext(mail, "Correo", "Opcional")

Rel_D(docente, webDoc, "Usa", "HTTP")
Rel_D(webDoc, auth, "Login", "HTTP JSON")
Rel_D(webDoc, alumnos, "CRUD", "HTTP JSON")
Rel_D(webDoc, banco, "CRUD", "HTTP JSON")
Rel_D(webDoc, plantillas, "CRUD", "HTTP JSON")
Rel_D(webDoc, omr, "Analiza", "HTTP JSON")
Rel_D(webDoc, vinculacion, "Vincula", "HTTP JSON")
Rel_D(webDoc, calificacion, "Califica", "HTTP JSON")
Rel_D(webDoc, analiticas, "Consulta", "HTTP JSON")
Rel_D(webDoc, sync, "Publica", "HTTP JSON")

Rel_D(auth, mongoLocal, "Lee/Escribe")
Rel_D(alumnos, mongoLocal, "Lee/Escribe")
Rel_D(banco, mongoLocal, "Lee/Escribe")
Rel_D(plantillas, mongoLocal, "Lee/Escribe")
Rel_D(omr, mongoLocal, "Lee")
Rel_D(vinculacion, mongoLocal, "Lee/Escribe")
Rel_D(calificacion, mongoLocal, "Lee/Escribe")
Rel_D(analiticas, mongoLocal, "Lee")
Rel_D(sync, mongoLocal, "Lee/Escribe")

Rel_R(plantillas, pdfStore, "Genera PDF")
Rel_R(omr, pdfStore, "Lee PDF")
Rel_R(sync, portalApi, "Publica resultados", "HTTP + API Key")
Rel_R(sync, mail, "Envia codigo", "SMTP")