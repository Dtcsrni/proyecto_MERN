%%{init: {'flowchart': {'curve': 'basis', 'nodeSpacing': 50, 'rankSpacing': 60}}}%%
flowchart TB
  classDef svc fill:#e0f2fe,stroke:#0284c7,color:#0c4a6e;
  classDef db fill:#ecfccb,stroke:#65a30d,color:#365314;
  classDef store fill:#f5f5f4,stroke:#78716c,color:#1c1917;
  classDef cloud fill:#ede9fe,stroke:#7c3aed,color:#4c1d95;
  classDef user fill:#fff6e5,stroke:#f59e0b,color:#7c2d12;

  subgraph Docker["Docker Compose (local)"]
    mongo_local[(mongo_local)]:::db
    api_docente_local[api_docente_local]:::svc
    web_docente_local[web_docente_local]:::svc
    pdf_local[[data/examenes]]:::store
  end

  docente[Docente]:::user --> web_docente_local
  web_docente_local --> api_docente_local
  api_docente_local --> mongo_local
  api_docente_local --> pdf_local

  subgraph CloudRun["Nube (Cloud Run / similar)"]
    portal_api[portal_alumno_cloud]:::cloud
    mongo_cloud[(MongoDB Cloud)]:::db
  end

  subgraph Static["Hosting estatico"]
    web_alumno[web_alumno - build app_alumno]:::svc
  end

  alumno[Alumno]:::user --> web_alumno
  web_alumno --> portal_api
  api_docente_local -->|sync + API Key| portal_api
  portal_api --> mongo_cloud