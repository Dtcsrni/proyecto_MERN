%%{init: {'theme':'base','themeVariables':{'background':'#FFFFFF','primaryColor':'#EAF2FF','primaryTextColor':'#0B1220','primaryBorderColor':'#1E3A8A','lineColor':'#1F2937','secondaryColor':'#E8FFF2','tertiaryColor':'#FFF4E5','fontFamily':'Arial','fontSize':'15px'}}}%%
%% Diagrama: estados de sesion del ContextoAutenticacionApp.
stateDiagram-v2
    [*] --> Cargando
    Cargando --> Autenticado: useEffect consultarApi /api/auth/me ok\nsetUsuario respuesta.usuario\nsetCargando false
    Cargando --> Invitado: useEffect consultarApi /api/auth/me error\nsetUsuario null\nsetCargando false

    Invitado --> Autenticado: iniciarSesion o registrarCuenta\nsetUsuario respuesta.usuario
    Autenticado --> Invitado: cerrarSesion\nconsultarApi /api/auth/logout\nsetUsuario null
    Autenticado --> Invitado: consultarApi /api/auth/me retorna 401
    note right of Cargando
      Nota:
      durante Cargando, RutaProtegida evita redirecciones prematuras.
    end note
    note right of Autenticado
      Nota:
      el estado depende de setUsuario y de respuestas de consultarApi.
    end note
