%%{init: {'theme':'base','themeVariables':{'background':'#FFFFFF','primaryColor':'#EAF2FF','primaryTextColor':'#0B1220','primaryBorderColor':'#1E3A8A','lineColor':'#1F2937','secondaryColor':'#E8FFF2','tertiaryColor':'#FFF4E5','fontFamily':'Arial','fontSize':'15px'}}}%%
%% Diagrama de clases: entidades y componentes de autenticacion usados en frontend/backend.
classDiagram
    class Usuario {
      +string _id
      +string correo
      +string hashContrasena
      +Rol rol
      +boolean activo
      +Date createdAt
      +Date updatedAt
    }

    class UsuarioToken {
      +string id
      +string correo
      +Rol rol
    }

    class ProveedorAutenticacion {
      +usuario: UsuarioToken | null
      +cargando: boolean
      +iniciarSesion(correo, contrasena)
      +registrarCuenta(correo, contrasena)
      +cerrarSesion()
      +setUsuario(...)
      +setCargando(...)
    }

    class consultarApi {
      +consultarApi(ruta, opciones): Promise T
      +credentials: include
    }

    class Rol {
      <<enumeration>>
      usuario
      desarrollador
      administrador
      super_usuario
    }

    UsuarioToken --> Rol : usa
    Usuario --> Rol : persiste
    ProveedorAutenticacion --> UsuarioToken : estado usuario
    ProveedorAutenticacion --> consultarApi : invoca

    note for Usuario "Coleccion Mongo principal usada por rutasAutenticacion."
    note for ProveedorAutenticacion "Fuente de verdad del estado usuario/cargando en React."
    note for consultarApi "Siempre usa credentials include para enviar cookie tokenAcceso."
