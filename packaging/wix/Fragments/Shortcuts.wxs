<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs">
  <Fragment>
    <ComponentGroup Id="CG.Shortcuts">
      <Component Id="CMP.ShortcutDesktopProd" Directory="DesktopFolder" Guid="7D746D16-3049-4EEE-AEC5-4B0FD25D79AE" Condition="INSTALL_DESKTOP_SHORTCUTS = 1">
        <Shortcut
          Id="SC.DesktopProd"
          Name="EvaluaPro - Prod"
          Description="Modo estable local: stack prod + portal"
          Target="[System64Folder]wscript.exe"
          Arguments="//nologo &quot;[INSTALLFOLDER]scripts\launcher-tray-hidden.vbs&quot; prod 4519"
          WorkingDirectory="INSTALLFOLDER"
          Icon="EvaluaProIconProd" />
        <RemoveFolder Id="RF.DesktopProd" On="uninstall" />
        <RegistryValue Root="HKLM" Key="Software\EvaluaPro" Name="DesktopProd" Type="integer" Value="1" KeyPath="yes" />
      </Component>

      <Component Id="CMP.ShortcutDesktopDev" Directory="DesktopFolder" Guid="80AF25AB-8F98-4DE0-AF43-C84F536FC779" Condition="INSTALL_DESKTOP_SHORTCUTS = 1">
        <Shortcut
          Id="SC.DesktopDev"
          Name="EvaluaPro - Dev"
          Description="Modo desarrollo local"
          Target="[System64Folder]wscript.exe"
          Arguments="//nologo &quot;[INSTALLFOLDER]scripts\launcher-tray-hidden.vbs&quot; dev 4519"
          WorkingDirectory="INSTALLFOLDER"
          Icon="EvaluaProIconDev" />
        <RemoveFolder Id="RF.DesktopDev" On="uninstall" />
        <RegistryValue Root="HKLM" Key="Software\EvaluaPro" Name="DesktopDev" Type="integer" Value="1" KeyPath="yes" />
      </Component>

      <Component Id="CMP.ShortcutMenuProd" Directory="EvaluaProMenuDir" Guid="86FC4E0A-3C0A-45A7-9B6F-4BD3EA1C90B8" Condition="INSTALL_STARTMENU_SHORTCUTS = 1">
        <Shortcut
          Id="SC.MenuProd"
          Name="EvaluaPro - Prod"
          Description="Modo estable local: stack prod + portal"
          Target="[System64Folder]wscript.exe"
          Arguments="//nologo &quot;[INSTALLFOLDER]scripts\launcher-tray-hidden.vbs&quot; prod 4519"
          WorkingDirectory="INSTALLFOLDER"
          Icon="EvaluaProIconProd" />
        <RegistryValue Root="HKLM" Key="Software\EvaluaPro" Name="MenuProd" Type="integer" Value="1" KeyPath="yes" />
      </Component>

      <Component Id="CMP.ShortcutMenuDev" Directory="EvaluaProMenuDir" Guid="CC7D14A6-C42B-40CC-8A35-A8C7CEB8D2A2" Condition="INSTALL_STARTMENU_SHORTCUTS = 1">
        <Shortcut
          Id="SC.MenuDev"
          Name="EvaluaPro - Dev"
          Description="Modo desarrollo local"
          Target="[System64Folder]wscript.exe"
          Arguments="//nologo &quot;[INSTALLFOLDER]scripts\launcher-tray-hidden.vbs&quot; dev 4519"
          WorkingDirectory="INSTALLFOLDER"
          Icon="EvaluaProIconDev" />
        <RegistryValue Root="HKLM" Key="Software\EvaluaPro" Name="MenuDev" Type="integer" Value="1" KeyPath="yes" />
      </Component>

      <Component Id="CMP.ShortcutMenuOpenDashboard" Directory="EvaluaProMenuDir" Guid="9B65D0BA-1659-4DB3-B7E8-5D1B4E8A4DD1" Condition="INSTALL_STARTMENU_SHORTCUTS = 1">
        <Shortcut
          Id="SC.MenuOpenDashboard"
          Name="EvaluaPro - Abrir Dashboard"
          Description="Abre dashboard local y asegura backend de control"
          Target="[System64Folder]wscript.exe"
          Arguments="//nologo &quot;[INSTALLFOLDER]scripts\shortcut-op-hidden.vbs&quot; open-dashboard 4519 auto"
          WorkingDirectory="INSTALLFOLDER"
          Icon="EvaluaProIconOpen" />
        <RegistryValue Root="HKLM" Key="Software\EvaluaPro" Name="MenuOpenDashboard" Type="integer" Value="1" KeyPath="yes" />
      </Component>

      <Component Id="CMP.ShortcutMenuRestartStack" Directory="EvaluaProMenuDir" Guid="D6B1CE99-1D23-422E-84F8-CCB675CB0078" Condition="INSTALL_STARTMENU_SHORTCUTS = 1">
        <Shortcut
          Id="SC.MenuRestartStack"
          Name="EvaluaPro - Reiniciar Stack"
          Description="Reinicia stack y valida salud de servicios clave"
          Target="[System64Folder]wscript.exe"
          Arguments="//nologo &quot;[INSTALLFOLDER]scripts\shortcut-op-hidden.vbs&quot; restart-stack 4519 auto"
          WorkingDirectory="INSTALLFOLDER"
          Icon="EvaluaProIconRestart" />
        <RegistryValue Root="HKLM" Key="Software\EvaluaPro" Name="MenuRestartStack" Type="integer" Value="1" KeyPath="yes" />
      </Component>

      <Component Id="CMP.ShortcutMenuStopAll" Directory="EvaluaProMenuDir" Guid="6CB230CC-5F29-4619-A43C-55D8D8326522" Condition="INSTALL_STARTMENU_SHORTCUTS = 1">
        <Shortcut
          Id="SC.MenuStopAll"
          Name="EvaluaPro - Detener Todo"
          Description="Solicita detener procesos activos del stack local"
          Target="[System64Folder]wscript.exe"
          Arguments="//nologo &quot;[INSTALLFOLDER]scripts\shortcut-op-hidden.vbs&quot; stop-all 4519 auto"
          WorkingDirectory="INSTALLFOLDER"
          Icon="EvaluaProIconStop" />
        <RegistryValue Root="HKLM" Key="Software\EvaluaPro" Name="MenuStopAll" Type="integer" Value="1" KeyPath="yes" />
      </Component>

      <Component Id="CMP.ShortcutMenuRepair" Directory="EvaluaProMenuDir" Guid="D7CEFD46-16FE-4E5E-BD8A-81FB6B0BE8A8" Condition="INSTALL_STARTMENU_SHORTCUTS = 1">
        <Shortcut
          Id="SC.MenuRepair"
          Name="EvaluaPro - Reparar Entorno"
          Description="Ejecuta reparación automática y validación de salud"
          Target="[System64Folder]wscript.exe"
          Arguments="//nologo &quot;[INSTALLFOLDER]scripts\shortcut-op-hidden.vbs&quot; repair 4519 auto"
          WorkingDirectory="INSTALLFOLDER"
          Icon="EvaluaProIconRepair" />
        <RegistryValue Root="HKLM" Key="Software\EvaluaPro" Name="MenuRepair" Type="integer" Value="1" KeyPath="yes" />
      </Component>
    </ComponentGroup>
  </Fragment>
</Wix>
